{% extends 'base.html' %}

{% block content %}
<div class="container-fluid" id="myDiv">
    <div class="row justify-content-center rounded-4 form-div-color my-5">
<div class="container-fluid">
    <h1 class="py-2 text-center">Výsledky pro faktura čslo {{ invoice.id }}</h1> <br>
        <h3 class="py-2 text-center">{{ invoice.nazev_faktury }}</h3>

    <div class="row">
   <div class="col-md-12">
        <h4 class="py-2">Data z JSON</h4>
        <!-- Tlačítko pro zobrazení/skrytí JSON -->
        <button id="toggleJsonButton" class="submit-invoice-button mb-5">Zobrazit JSON</button>

        <!-- Div pro JSON data -->
        <div id="jsonData">
            <pre>{{ result | tojson(indent=2) | safe }}</pre>
        </div>
    </div>

    <script>
        // JavaScript pro přepínání viditelnosti JSON data
        document.getElementById('toggleJsonButton').addEventListener('click', function() {
            var jsonDataDiv = document.getElementById('jsonData');
            var button = document.getElementById('toggleJsonButton');

            if (jsonDataDiv.style.display === 'none') {
                jsonDataDiv.style.display = 'block';
                button.textContent = 'Skrýt JSON'; // Změna textu tlačítka
            } else {
                jsonDataDiv.style.display = 'none';
                button.textContent = 'Zobrazit JSON'; // Změna textu tlačítka
            }
        });
    </script>

        <div class="col-md-6">
    <h2>Vytěžené údaje z faktury</h2>
    </div>
                <div class="col-md-6">
            <h2>Skutečné údaje na faktuře </h2>
    </div>
<div class="col-md-8">
    <dl class="row">
{% for key, description in key_descriptions.items() %}
            {% set value = json_data.get(key, None) %}
            {% if key not in ['VAT_RATE', 'PRICE_INCLUDING_VAT', 'PRICE_WITHOUT_VAT', 'VAT_AMOUNT'] %}
                <dt class="col-sm-4">{{ description }}</dt>
                <dd class="col-sm-8">{{ value if value is not none else 'null' }}</dd>
            {% endif %}
        {% endfor %}

        {% if 'VAT_TABLE' in json_data %}
            {% for vat_entry in json_data['VAT_TABLE'] %}
                <dt class="col-sm-4">{{ key_descriptions['VAT_RATE'] }}</dt>
                <dd class="col-sm-8">{{ vat_entry['VAT_RATE'] }}</dd>

                <dt class="col-sm-4">{{ key_descriptions['PRICE_INCLUDING_VAT'] }}</dt>
                <dd class="col-sm-8">{{ vat_entry['PRICE_INCLUDING_VAT'] }}</dd>

                <dt class="col-sm-4">{{ key_descriptions['PRICE_WITHOUT_VAT'] }}</dt>
                <dd class="col-sm-8">{{ vat_entry['PRICE_WITHOUT_VAT'] }}</dd>

                <dt class="col-sm-4">{{ key_descriptions['VAT_AMOUNT'] }}</dt>
                <dd class="col-sm-8">{{ vat_entry['VAT_AMOUNT'] }}</dd>
            {% endfor %}
        {% endif %}
    </dl>
</div>
        <div class="col-md-4">



<dl class="row">
                <dd>{{ invoice.evidencni_cislo }}</dd>

                <dd>{{ invoice.typ_faktury }}</dd>

                <dd>{{ invoice.adresa_dodavatele }}</dd>

                <dd>{{ invoice.jmeno_dodavatele }}</dd>

                <dd>{{ invoice.ico_dodavatele }}</dd>

                <dd>{{ invoice.dic_dodavatele }}</dd>

                <dd>{{ invoice.cislo_uctu }}</dd>

                <dd>{{ invoice.variabilni_symbol }}</dd>

                <dd>{{ invoice.datum_vystaveni }}</dd>

                <dd>{{ invoice.datum_uzp }}</dd>

                <dd>{{ invoice.datum_splatnosti }}</dd>

                <dd>{{ invoice.platebni_metoda }}</dd>

                <dd>{{ invoice.mena }}</dd>

                <dd>{{ invoice.rpdp }}</dd>

                <dd>{{ invoice.zaokrouhleni }}</dd>
            </dl>
        </div>
    </div>


<dl class="row">
    <!-- Porovnání Variabilní symbol -->
    <dt class="col-sm-4">Variabilní symbol</dt>
    <dd class="col-sm-8">{{ invoice.variabilni_symbol }}</dd>
    <dt class="col-sm-4">Variabilní symbol (JSON)</dt>
    <dd class="col-sm-8">
        {{ json_data.get('VARIABLE_SYMBOL', 'N/A') }}
        {% if json_data.get('VARIABLE_SYMBOL') == invoice.variabilni_symbol %}
            (Shoduje se)
        {% else %}
            (Neshoduje se)
        {% endif %}
    </dd>

    <!-- Další porovnání -->
    <dt class="col-sm-4">IČ dodavatele</dt>
    <dd class="col-sm-8">{{ invoice.ico_dodavatele }}</dd>
    <dt class="col-sm-4">IČ dodavatele (JSON)</dt>
    <dd class="col-sm-8">
        {{ json_data.get('IC_SUPPLIER', 'N/A') }}
        {% if json_data.get('IC_SUPPLIER') == invoice.ico_dodavatele %}
            (Shoduje se)
        {% else %}
            (Neshoduje se)
        {% endif %}
    </dd>
</dl>
</div>
</div>

</div>
{% endblock content %}


